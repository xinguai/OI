��׺�����Ļ���Ӧ�� By strongoier

���������������ǰ�����幵�������ѧ�ġ�

�����ıʼǻ���ֻ����ģ�ͽ�����ת�����ض�ģ�͵��������ο����ġ�

��׺���飺�ַ����ĺ�׺������

height���飺���ں�׺�������ǰ׺��

�����ؼ�����׺�������ԡ�

һ��ֱ��Ӧ�ã���׺����

����1��BZOJ 1031 �ַ�����

��ԭ�ַ�������һ�����к�׺���򣬾͵õ���ԭ����ת���ĸ������Ĵ�С��ϵ��Ȼ����˳���������ɡ�

���������ַ���

1���ظ��Ӵ������������顣

����2��POJ 1743 Musical Theme

Ҫ���Ӽ���������ͬ���ֶΣ���ô��һ��Ҫ��ԭ���������õ������飬��Ȼ��һλ��Ҫ���⴦���ģ�Ȼ����ת��Ϊ�˲����ص���ظ��Ӵ����⣬����Ҫע�����жϵ�ʱ����������ͬ�γ��ȼ�1����ԭ������ͬ�γ��ȡ�

����3��POJ 3261 Milk Patterns

���ٳ���k�ο��ص���ظ��Ӵ����⣬���������ĳ�ʼֵ�ϴ󣬵�һ������ͨ��sort���ɺ�׺�����ĳ�ʼ�����̡�

2���Ӵ�����

����4��SPOJ DISUBSTR/SUBST1

��׺��������С�������δ��������ֺ͵�i������ǰ׺��ı�Ȼ�ǵ�i - 1��������height[i]��ǰ׺�ѱ�֮ǰ����������ô���Ĺ���ֵΪn - sa[i] - height[i]�����ͼ��ɡ�

3�������Ӵ����������ƣ�ö�����ġ�

����5��Ural 1297 Palindrome

������Ӵ����⣬ע����i��j�������ǰ׺ʱ�Ƚ�i��j�Ĵ�С����ʵ������RMQ(i + 1, j)��

4�������ظ��Ӵ���ö���������ֲ���

����6��SPOJ REPEATS

�ظ��������������ظ��Ӵ����⣬ö���ظ��Ӵ�����L�����������ظ����ε�������ö��s[0], s[L], s[2 * L], ..., s[N / L * L]������������������s[i]��s[i + L]������ʱ������Ҳ���ҵ��˿��������ظ���λ��i����Ȼ���ǲ�֪��i���Ӵ�����һλ������ͨ����LCP(i, i + L) / L���Եõ��ظ����������ޡ�ͬʱ���ǿ��Է��ֳ���������һ��������ֻ�е��Ӵ�����ʼλ����ǰ����L - ����ʱ���ظ������Ż�����1�����Դ��������������Ϳ��Եõ���ʱ�Ĵ𰸡�

����7��POJ 3693 Maximum repetition substring

����һ��������һ��������Ҫ�������ֵ�����С�ķ�������ʱ�Ͳ���ֻ���Ǵ����ˣ���Ҫ���ν�λ�õ�ǰ�ƽ���ö�٣���ÿ�εõ��Ĵ𰸽����ֵ����Ƚϡ�

���������ַ�������β����

1�������Ӵ�

����8��POJ 2774 Long Long Message

������Ӵ������Ӻ������Ƿ��֣�ֻ�е�������a���ĺ�׺��������b���ĺ�׺��������ʱheight�������壬��Ϊ����ԽԶheight��ֻ����ԽС�ģ���ֱ��ɨһ��height���鼴�ɡ�

2���Ӵ�����

����9��POJ 3415 Common Substrings

�󳤶Ȳ�С��k�Ĺ����Ӵ��ĸ��������Ӻ������������ֱ���������������׺�������ǰ׺lcp >= k��ô���Ǿ�Ҫ��lcp - k + 1�ۼ����𰸡�����׺��С˳������ʱ�����Ƿ��֣�һ����׺��ǰ������׺�������ǰ׺�ǵݼ��ģ�Ҳ����˵����һ��height��Сʱ��ǰ���ٴ���height����û�������ģ���������Ҫά��һ������ջ��ʹ��ÿ��height������ջ��ջ��Ԫ�ص�������ջʱע���ۼӶ�Ӧ���ĸ�����������һ�εĴ𰸽��м��㣬���������𰸣�ʵ��ʱҪ��ϸ�ڴ����á�������������ÿһ��A����׺������С��B����׺�𰸼���ÿһ��B����׺������С��A����׺�𰸾����ˣ�ע������Ҫʹ��long long��

�ġ������ַ���

#include <cmath>
#include <cstdio>

const double EPS = 1e-12;
const int MAXN = 11, MAXM = 111111;

struct state {
    double p;
    int bit, sum;

    inline state(double _p = 0, int _bit = 0, int _sum = 0) :
        p(_p), bit(_bit), sum(_sum) {}

    inline bool operator < (const state &x) {
        return fabs(p - x.p) < EPS && sum < x.sum || p < x.p;
    }
};

double a[MAXN][MAXM];
int s[MAXM];
priority_queue<state> f[2];

int main() {
    //freopen("kobe.in", "r", stdin);
    //freopen("kobe.out", "w", stdout);
    int n, m;
    scanf("%d%d", &n, &m);
    for (int i = 0; i < m; ++i)
        scanf("%d", &s[i]);
    for (int i = 0; i < n; ++i)
        for (int j = 0; j < m; ++j)
            scanf("%lf", &a[i][j]);
    f[1].push(state(1, 0, 0));
    for (int i = 0; i < m; ++i) {
        int p = i & 1, q = p ^ 1;
        for (int c = 0; !f[q].empty(); ++c, f[q].pop())
            for (int k = 0; c < n && k < n; ++k)
                if (!((f[q].top().bit >> k) & 1))
                    f[p].push(state(f[q].top().p * a[k][i], f[q].top().bit ^ (1 << k), f[q].top().sum + s[i]));
    }
    printf("%.11lf\n%d\n", f[(m - 1) & 1][(1 << n) - 1], g[(m - 1) & 1][(1 << n) - 1]);
    return 0;
}
